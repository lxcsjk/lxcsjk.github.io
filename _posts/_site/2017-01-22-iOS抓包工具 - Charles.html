<p>过年也在家也没啥事情，闲着无聊就整理整理自己学习iOS的经历以及解决的问题and知识点（虽然我很菜😂😂）。温故而知新吧😀😀</p>

<hr />

<p><strong>Charles</strong> 一个网络抓包工具，可以清晰看到网络请求参数值以及返回的response结果。对于日常开发还是非常有帮助的。</p>

<h3 id="charles">安装 Charles</h3>

<p><a href="https://www.charlesproxy.com/">有钱请支持正版</a></p>

<p><a href="http://oh6uhie7j.bkt.clouddn.com/charles-proxy-4.0.1.zip">没钱戳这里(请支持正版)</a></p>

<p>拖入  <strong>应用程序</strong>  即可</p>

<hr />

<h3 id="charles-1">Charles的简单使用</h3>

<ol>
  <li>将Charles设置成系统的代理服务器。</li>
</ol>

<p>如图。</p>

<p><img src="http://oh6uhie7j.bkt.clouddn.com/QQ20170122-193921@2x.png" alt="" /></p>

<p>然后就可以看到很多网络请求出现在Charles的界面里</p>

<p><img src="http://oh6uhie7j.bkt.clouddn.com/QQ20170122-193551@2x.png" alt="" /></p>

<ol>
  <li>显示视图</li>
</ol>

<p>Charles提供了两种显示视图的方式，分别为 <strong>Structure</strong> 和 <strong>Sequence</strong>。</p>

<p>区别如下：</p>

<ul>
  <li><strong>Structure</strong> 视图将网络请求按访问的域名分类。</li>
  <li><strong>Sequence</strong> 视图将网络请求按访问的时间排序。</li>
</ul>

<p>前面的图为<strong>Structure</strong></p>

<p>下面的图为<strong>Sequence</strong>
<img src="http://oh6uhie7j.bkt.clouddn.com/QQ20170122-194802@2x.png" alt="" /></p>

<p>单击其中一个网络请求，根据面板上的tag即可在下面空白看到相应的<strong>request</strong>请求参数和<strong>response</strong>返回结果了</p>

<ol>
  <li>过滤网络请求</li>
</ol>

<ul>
  <li>在 <strong>Sequence</strong> 视图模式有一个 <strong>Filter</strong> 的输入框</li>
</ul>

<p><img src="http://oh6uhie7j.bkt.clouddn.com/QQ20170122-195706@2x.png" alt="" /></p>

<ul>
  <li>另一种方式，选中一个在右键出的下拉菜单中点击 <strong>Focus</strong>，然后<strong>Filter</strong> 的输入框后面勾选 <strong>Focused</strong></li>
</ul>

<p><img src="http://oh6uhie7j.bkt.clouddn.com/QQ20170122-200349@2x.png" alt="" /></p>

<ul>
  <li>在 <strong>Structure</strong> 视图模式 在菜单栏选择 <code class="highlighter-rouge">Proxy-&gt;Recording Settings</code>，然后选择 Include 栏，选择添加一个项目，然后填入需要监控的协议，主机地址，端口号。</li>
</ul>

<p><img src="http://oh6uhie7j.bkt.clouddn.com/QQ20170122-200139@2x.png" alt="" /></p>

<hr />

<h3 id="section">抓取移动设备上的请求封包</h3>

<ol>
  <li>设置Charles的代理功能 如图</li>
</ol>

<p><img src="http://oh6uhie7j.bkt.clouddn.com/QQ20170122-201137@2x.png" alt="" /></p>

<ol>
  <li>手机上的设置</li>
</ol>

<p>PC和手机最好用同一个网关要方便点，毕竟都是在办公室工作嘛。</p>

<ul>
  <li>获取到电脑的ip地址</li>
</ul>

<p><img src="http://oh6uhie7j.bkt.clouddn.com/QQ20170122-201522@2x.png" alt="" /></p>

<ul>
  <li>设置手机的HTTP代理</li>
</ul>

<p>进入到 “设置” - “无线局域网” - “【你的WiFi名字】旁边的详情”
向下拉到最底，填入你PC的ip和Charles的代理端口号</p>

<p><img src="http://oh6uhie7j.bkt.clouddn.com/6646E7369EAC5D316F3E2C9AFD4C5513.png" alt="" /></p>

<p>选择 <strong>Allow</strong></p>

<p><img src="http://oh6uhie7j.bkt.clouddn.com/QQ20170122-202158@2x.png" alt="" /></p>

<p>在面版将会看到手机发出接受的网络请求了。</p>

<hr />

<h3 id="https">抓包HTTPS</h3>

<ol>
  <li>安装 <strong>Charles</strong> 的CA证书</li>
</ol>

<p>“菜单栏” - “SSL Proxying” - “Install Charles Root Certificate”</p>

<p><img src="http://oh6uhie7j.bkt.clouddn.com/QQ20170122-202745@2x.png" alt="" /></p>

<p>在钥匙串中可以搜索到
<img src="http://oh6uhie7j.bkt.clouddn.com/QQ20170122-202909@2x.png" alt="" /></p>

<p>然后选中一条 HTTPS 请求，右键选择 <strong>Enable SSL proxy</strong> 然后就能看到不再乱码的请求信息了</p>

<p><img src="http://oh6uhie7j.bkt.clouddn.com/QQ20170122-203656@2x.png" alt="" /></p>

<ol>
  <li>抓包移动设备的SSL请求</li>
</ol>

<p>这里需要在手机上安装一个证书，如图</p>

<p><img src="http://oh6uhie7j.bkt.clouddn.com/C140ACC2-C585-4CCA-9CE2-394FCA2B9359.png" alt="" /></p>

<p><img src="http://oh6uhie7j.bkt.clouddn.com/QQ20170122-203821@2x.png" alt="" /></p>

<p>弹出一个提示告诉你 需要设置代理然后用手机浏览器打开一个地址安装一个证书  <a href="http://chls.pro/ssl">地址</a></p>

<p><img src="http://oh6uhie7j.bkt.clouddn.com/1D32AC22C2B0BF8458259E30A7DF427F.png" alt="" /></p>

<p>然后和上面一样 <strong>Enable SSL proxy</strong></p>

<p>example ~</p>

<p>抓包keep的小视频</p>

<p><img src="http://oh6uhie7j.bkt.clouddn.com/QQ20170122-205909@2x.png" alt="" /></p>

<hr />

<h3 id="section-1">模拟网络环境差</h3>

<p>Charles提供这样的支持，只需要更改添加配置与host即可。如图</p>

<p><img src="http://oh6uhie7j.bkt.clouddn.com/QQ20170122-205122@2x.png" alt="" /></p>

<hr />

<p>目前常常用到就是这么多~~~ 如果有不足可以看看 <a href="http://blog.devtang.com/2015/11/14/charles-introduction/">唐巧大神的博客</a></p>
